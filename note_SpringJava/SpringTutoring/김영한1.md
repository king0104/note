### 스프링 웹 개발 기초

- 정적 컨텐츠

  - 그냥 HTML 그대로 반환해준다

    ---

- mvc와 템플릿 엔진

  - 컨트롤러가 요청 받음
  - view를 거친다 - html파일 필요함

- API

  - @ResponseBody 사용

  1. 문자열 그대로 내려주는 방식
     - 데이터 문자열
  2. 객체 그대로 내려주는 방식
     - 데이터가 json형식

---

### 스프링 빈에 객체 생성 및 의존관계 주입

![image-20210728222031884](C:\Users\4545a\AppData\Roaming\Typora\typora-user-images\image-20210728222031884.png)



1. 각 객체가 스프링 빈에 생성된다 - by **annotation**

2. 의존관계가 주입된다 - by **@Autowired**

   

#### TIP. 정형화된 패턴

- 컨트롤러 - 컨트롤러 통해서 외부 요청을 받고
- 서비스 - 서비스에서 비즈니스 로직을 만들고
- 리포지토리 - 리포지토리에서 데이터를 저장한다.

각각 어노테이션을 적어주면, 스프링이 뜰 때 컨트롤러, 서비스, 리포지토리 객체를 **스프링 빈에 각각 등록**하게 된다!!!



#### 1. 객체를 스프링 빈에 생성할때

**@Controller, @Service, @Repository** 붙여주기



#### 2. 연결시켜 줄 때

#### 1. 컴포넌트 스캔 방식 - @Autowired 사용

- 컨트롤러는 서비스가, 서비스는 리포지토리가 필요하다

- @Autowired 사용

- 생성자 위에 사용
- Dependency Injection, 의존성 주입
  - 컨트롤러 호출할 때, 스프링이 그 속에다가 서비스를 주입해주는 것
  - 서비스를 호출할 때, 스프링이 그 속에다가 리포지토리를 주입해주는 것
  - 생성자의 매개변수에 있는 것을 주입시켜주는 것.

#### 2. 자바 코드로 직접 스프링 빈 등록하기





---

### GetMapping vs PostMapping

- url + enter. 즉, 조회할 때
- 데이터를 전달할 때



form 태그.



---

![image-20210728231123979](C:\Users\4545a\AppData\Roaming\Typora\typora-user-images\image-20210728231123979.png)

1. 루프를 돌면서, members에서 하나를 꺼내 member로 설정
2. member.id 출력
3. member.name 출력



이렇게 데이터를 관리하면, 스프링을 재시작하면 메모리에 있던 저장값들 다 날라간다.

그래서 데이터베이스를 이용하는데, 다음 시간에 알아볼 내용이다.



---

beforeeach, aftereach 찾아보기

---

### 순수 jdbc

db와 연결시켜주기

1. gradle 추가 설정 선언
   - 해당 db가 존재하는 jdbc url 정확히 적어주자(test2인지 test인지,,, 이걸로 한시간 잡아먹음)
2. jdbc리포지토리를 만들어서, 이제 거기다가 멤버 리포지토리를 구현한다!!
   - 이때, datasource라는 것이 필요함
     - datasource를 주입받아야 한다.
     - 스프링부트가 데이터 소스를 만들어준다
     - 여기에 이제 쿼리문을 날려서 데베에 전달하고 전달 받는 것이다



---

### 스프링 통합 테스트

#### @Transactional 사용 이유

<개념>

db는 transcation이라는 것이 존재한다. 실제로는 데이터베이스로 값을 주고, 그 값을 커밋해야지 db로 값이 넘어간다. 편하게 오토커밋 기능이 있어서 바로 넘어가는 것이라고 생각되는 것이다.

그러면, 중간에서 커밋 되기 전, 데이터 롤백을 시키면 중복값일 때라도 여러번 test가 가능해지는 것이다.

<사용>

*테스트 케이스* 위에다가 해당 어노테이션을 달면, 테스트만 돌린 후, 데이터 값은 디비에 넣지 않고 다시 데이터를 롤백해오게 된다.

**즉, 다음 테스트를 계속 넣을 수 있다 ( db에 테스트 데이터가 반영이 안된다)**



#### 통합 테스트 vs 단위 테스트

- 통합테스트 
  - 스프링도 띄우고, db도 연동해서 진행하는 테스트
  - 여기서 @Transactional 사용
  - 시간이 오래걸림
- 단위테스트
  - 순수 자바 코드로 진행하는 테스트
  - 시간이 빠름 - 좋은 테스트 체크용일 가능성 높다



---

### 스프링 jdbcTemplate

순수 Jdbc와 동일한 환경설정을 하면 된다.  

스프링 JdbcTemplate과 MyBatis 같은 라이브러리는 JDBC API에서 본 반복 코드를 대부분 제거해준다. 하지만 SQL은 직접 작성해야 한다.

사용법은, jdbcTemplate 메뉴얼 검색하면 많이 나온다.



alt + enter : 람다식으로 변환

1. 데이터베이스 주입

   ![image-20210729175701990](C:\Users\4545a\AppData\Roaming\Typora\typora-user-images\image-20210729175701990.png)

2. 멤버 찾는 메서드 작성

   ![image-20210729175721698](C:\Users\4545a\AppData\Roaming\Typora\typora-user-images\image-20210729175721698.png)

   RowMapper 가 필요하다

![image-20210729175728744](C:\Users\4545a\AppData\Roaming\Typora\typora-user-images\image-20210729175728744.png)



어쩌구저쩌구~~~



다음 시간에는 **쿼리까지 없앨 수 있는 jpa **공부!!!
