A.   Entity Manager 의 역할은 무엇인가요?

- 엔티티를 등록, 수정, 조회, 삭제 작업을 진행할 수 있다. 그래서, 가상 데이터베이스라고 생각해도 무방하다.
- 엔티티를 영속성 컨텍스트에 저장하는 역할을 한다.



B.   영속성 컨텍스트를 설명해주세요.

- 엔티티를 영속 상태로 만들어두는 공간

- 1차 캐시와 쓰기지연 sql 저장소로 이루어져있다.

- 특징으로는,

  - 1차 캐시
  - 동일성 보장
  - 쓰기 지연
  - 변경 감지
  - 지연 로딩  

  이 있다.



C.   Flush 기능이 어떤 역할을 수행하는 지와 왜 필요한지 설명해주세요.

- 영속성 컨텍스트의 내용과 데이터베이스의 내용을 동기화시켜주는 역할
- 구체적으로는 다음과 같은 2가지 과정을 수행한다
  1. 변경 감지 동작. 영속 엔티티 & 스냅샷 비교하여 수정 쿼리 생성
  2. 쓰기지연 sql 저장소의 쿼리를 데이터베이스에 전송
- 핵심적으로는 쓰기 지연이라는 작업을 수행하기 위해서이고, 조금 더 크게 말하자면 영속성 컨텍스트의 변경 내용을 데이터베이스에도 적용해야하기 때문이다.



D.   비영속 / 영속 / 준영속 / 삭제 상태가 무엇인지 설명해주세요.

엔티티의 상태를 말한다.

- 비영속
  - 영속성 컨텍스트와 전혀 관계가 없는 상태
- 영속
  - 영속성 컨텍스트에 저장된 상태
- 준영속
  - 영속성 컨텍스트에 저장되어 있다가, 분리된 상태
- 삭제
  - 영속성 컨텍스트에서 분리됨과 동시에, 삭제 쿼리가 생성된다.
  - 영속성 컨텍스트에서도 분리 & 데이터베이스에서도 삭제 된 상태이다.



E.   Merge() 메소드는 어떤 동작을 수행하는 지 설명해주세요.

- 준영속 상태 엔티티를 이용하여 -> 영속 상태의 새로운 엔티티를 만들어낸다.
- 주의할 점
  - 준영속 상태 엔티티는 계속 준영속 상태로 남아있다 & 영속 상태의 새로운 엔티티가 반환된다
    - 리턴 엔티티를 준영속 상태 엔티티와 동일하게 주면, 이 문제 해결

