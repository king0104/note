#### 0. spring 기본 설정

- dependency
  - spring-boot-starter
    - 스프링 부트에 필요한 dependency를 자동으로 추가해준다.
    - @Controller, @Service와 같은 것들 사용 가능하게 함. 즉, restful한 개발을 위해 필요

---

- 기본적으로, 아래에서부터 구조를 짜는 것이다. 즉, repository -> service -> controller 순이다.
- 따라서, repository가 접근할 DB를 만드는 것이 최우선이다.

### 1. DB 만들기 -> Entity 클래스 만들기

1. DB를 만드려면, 

   - 엔티티

   - 연관관계

​	를 파악한 후, DDL을 통해 DB에 테이블을 작성한다.



2. 엔티티 클래스를 작성한다.

   - DDL로 만든 DB의 테이블과 알맞게 엔티티 클래스를 작성한다.

   - **이때 너무 중요한 점!!!! DB의 어떤 하나의 클래스에서, (다른 엔티티의 pk가) FK로 존재하는 경우에는 -> 자바의 엔티티에서, 다른 엔티티의 pk(즉, fk 컬럼)를 넣는 것이 아니고, 다른 엔티티 그 자체를 컬럼으로 넣는다!!**

   - ![image-20220116123917574](C:\Users\4545a\AppData\Roaming\Typora\typora-user-images\image-20220116123917574.png)

     - 테이블 -> 엔티티
   
     - 칼럼 -> 칼럼
   
     - 연관관계 -> 어노테이션 
     
       으로 작성해준다.

---

### 2. 연관관계 설정하기

연관관계는 어노테이션으로 정해준다고 했다. 물론 다른 것들도 어노테이션이지만, 연관관계는 특히 @ManyToOne & @JoinColoumn  / @OneToMany(mappedBy = " ") 등 복잡한 어노테이션을 갖고 있기 때문에, 그렇게 말해두었다.

1. 연관관계 확인하기 (n대1 찾기)
   - db 설계도를 보고, n대1 관계를 먼저 찾자. n이 주인이 될 것이기 때문에 그렇다.

2. 연관관계 별로 어노테이션 및 설정

#### N:1 (N측 엔티티)

- @ManyToOne
- @JoinColumn(name = " ")
  - 주인 엔티티에 사용하는데, 일반적으로 n측을 주인으로 설정한다.
  - name = "매핑할 db의 컬럼 이름"

#### 1:N (1측 엔티티)

- @OneToMany(mappedBy = " ")
  - mappedBy는 주인이 아닌 엔티티에 사용한다. 일반적으로 1측이 주인이 아니므로, 위와 같이 사용하게 된다.
  - mappedBy = "@ManyToOne으로 매핑되어있는 필드값(엔티티인 경우가 많다)"
- @OneToMany는, 자바 상으로 코드에서만 사용하기 위해 적는 것이다. 즉, 비즈니스 로직 상에서 1측에서 n측을 참조하고 싶은 경우에 적는 것이지, 필수는 절대 아니다.
  - team과 member의 관계를 생각해보면 된다. 여기서는 참조하고 싶기 때문.


---

- mappedBy와 JoinColumn에서 알 수 있듯, **우리는 주인측(다 측)에서 db의 컬럼에 접근하는 것을 알 수 있다.**
-  즉, 주인이 FK를 관리한다는 뜻이다. 
- **주인이 아닌 측은, 그냥 자바 상으로 코드만 존재하는것이지, DB와 전혀 상관없다고 봐도 무방하다.**

---

### 3. 레포지토리 -> 서비스 -> 컨트롤러 작성하기

- 레포지토리, 서비스, 컨트롤러를 엔티티 당 하나씩 만들게 된다.
- 추가로,   DTO를 만들기도 한다.

  - DTO는, 클라이언트, 컨트롤러, 서비스 사이에서 사용.
  - 컨트롤러에서 DTO를 엔티티로 변환하는 작업을 한다.
  

---

1. 3번에서 가장 중요한, **"비즈니스 로직"을 정하자.**
     - 예시)
       - 상품 등록하기
       - 주문 등록하기
       
     
2. 비즈니스 로직을 수행하기 위해, **어떤 값을 받고 컨트롤러, 서비스, 레포지토리에서 어떤 동작을 하면 될 지 정리하자.**

    1. 상품 등록
       - 상품의 정보를 받아서,  db에 item 클래스를 저장하면 된다.
    2. 주문 등록
       - 주문자 이름과, 아이템 이름을 받아서 order 클래스를 저장한다



#### 1. Repository (JpaRepository ver.)

- ```java
  @Repository
  public interface ItemRepository extends JpaRepository<Item,Long> {
      Optional<Item> findByName(String name);
  }
  ```



#### 2. Service



