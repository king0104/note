## 3주차

### 2주차 과제 피드백

#### 포트포워딩

- 외부포트가 밖에서 들어오는 포트. 이게 중요한 것이다
- 내부포트는 사실 아무거나 해도 상관 없음



#### aws ec2 사용해서 서버 구축 / linux + Nginx PHP MYSQL

- datagrip을 mysql에 연결 시에, 데이터그립 time zone 설정을 맞춰주어야 한다.



#### 내 감상

- 와 근데 다 블로그에다가 정리하거나 노션에 정리해놨네... 나도 앞으로 정리 하면서 공부해야지. 
  - 블로그에 과제 올리기
  - 내 코드 깃허브에 올리기

#### 과제 총 피드백

- db에 접속하는 방법 3가지
  1. datagrip
     - db에 있는 3306번 포트로 붙어야 한다.
  2. phpmyadmin - 
     - my : mysql
     - **웹페이지 형식**이기 때문에 포트 80번. 
     - 443
  3. 터미널 - 서버에 직접 접속한 것임.



---



## 데이터베이스

- 떠오르는 것?
  1. DBMS
  2. 스키마 - mysql에서는 테이블, 스키마 같은 의미.
  3. 테이블
  4. 관계형
  5. NoSQL
  6. user



1. DB vs DBMS

- 데이터 자체 vs 조작시스템.
- sql이라는 시스템을 이용하여 dbsm에게 db에 뭘 하라는 것을 말하는 것임



2. 관계형 - 개발 잘하기 위해선 이게 중요

- DB -> DB -> DB -> DB 식으로 관계가 이루어진 것.
- 책db에서 책이름 몇가지 중에  한가지 선택 -> 그 책 안에서 목차db -> 목차DB 내에서 단어 선택,  단어 DB



3. NoSQL - 딥하게 들어갈 일 없다

- 클릭 하나도 데이터인데 이걸 어떻게 관계를 맺냐. 그냥 클릭 1 이런식으로 하자





### 데이터베이스 만들기

0. 앱 제작 전 데이터베이스 기획서 만들기

1. 관계 구조 짜기 / UML

   - DB 모델링

     1. 개념적 모델링

        - 결국 현실세계의 무언가를 db로 옮기는 것이다

        - NTT로 '책'DB , '목차'DB 만드는 순간 -> 책은 현실세계가 아니라 추상화가 되는 것임.

        - 책DB)

          - 테이블
            - 저자
            - 이름
            - 출판사
            - **도서코드 - primary key**

        - 목차DB)

          - 테이블

            - 목차 제목

            - 도서코드 - 책을 하나로 결정짓는 특징

            - **인덱스 - primary key**

              - (테이블에서는 무조건 primary key 하나가 필요하다)

              - (실제로는 비즈니스 로직을 primary key로 설정하지 않는다. 왜냐하면 진짜 미래에 그 비즈니스 로직(예를 들어 주민등록번호)이 진짜로 나중에 2명이 1개를 쓰는 상황이 올 수도 있기 때문이다) (그래서, 실제로는 인덱스 - 아무의미없는 숫자 - 로 primary key를 잡는다.)

                

          

     2. 논리적 모델링

        - 관계 구조 짜기
        - primary key
          - 데이터에게 의미없는 숫자를 주어서 중복을 방지하는 것이다.
          - 하나의 row를 특정하기 위한 key값
          - ex) 주민등록번호
        - foriegn key
        - unique key
        - ...etc
        - 조건 부여하기

     3. 물리적 모델링

        - 실제로 SQL문 짜는 것이다
        - 이때 실제로, 논리적 모델링에서 사용한 NTT가 테이블이 된다
        - 클러스터링
        - 인덱싱

     => 이걸 하면, 이제 DB가 되는 것이다!!



#### 연관관계 맺기

1. 1 : 1

2. 1 : M

3. M : M

   - 주문

   - 사용자와 물건의 관계가 M : M 관계 - 사용자가 모든 물건 살 수 있고 물건도 모든 사용자에 의해 선택될 수 있기 떄문이다

   - **중간**에 주문 테이블 넣어주기 - M:M 관계 해소

      	1. 주문 ID - primary key
      	2. 사용자 ID - foriegn key
      	3. 물건 ID - foriegn key

     주문 입장에서는 사용자가 단 하나만 선택하고, 물건도 주문에 대해서 하나만 선택받을 수 있다. 각각 1댸1 대응이 되는 것이다.



### 이번주 과제

db모델링

모델링 한 데이터베이스 기반으로 쿼리문 짜오는 것.

데이터그립 - 쿼리 콘솔 들어가기 - 쿼리문 작성 가능



#### SQL문

1. DDL
   - CREATE문. - CREATE DATABASE CREATE TABLE
   - ALTER문 - 데이터 타입을 변경함.
   - DROP문
   - TRUNCATE문 - 테이블 냅두고 데이터만 지우기

2. **DML**

   - select

   - INSERT

   - UPDATE

     

3. DCL
   - GRANT문 : 유저한테 권한 주는 것
   - REVOKE문 : 그 계정의 권한 삭제

4. TCL : tranjaction - 하나의 명령 단위
   - COMMIT문 : DB에 적용된다
   - ROLLBACK문 : DB에 대한 명령 취소



### *tip*

1. primary key를 만들어라
   - 테이블이름ID로 만들면 좋음

2. 데이터 삭제하지 않기

   - 데이터가 삭제될 때, DELETE 해야 하는데, 보통은 완전히 지우지 않는다. 사용자가 탈퇴하는 예시에서, 데이터를 삭제하지 않고 사용자의 상태를 나타내는 column을 만든다. 그걸로 o,x 판단하는 것. 데이터를 삭제하지 말기!!

3. CREATEAT / UPDATEAT 넣기

   - 생각보다 업로드 한 날짜, 수정한 날짜가 많이 쓰인다. 이 컬럼 넣기.
   - 인스타 게시물 이런거 아니더라도 모든 데이터에서 시간을 기록하는 행위는 권장된다. 결국 데이터는 돈이니까 넣어두기.
   - UPDATEAT은 아직 수정하지 않았으면, NULL값을 주던가, 아니면 CREATEAT과 같은 값으로 초기화를 주던가.
   - UPDATEAT은 case when 시간 과 함께 쓰일 수 있다. 블로그 참고!

   

#### 데이터 모델링 하는 곳 - **Aquery tool 웹사이트** 이용

로그인

user index

name, type,

- null
  - null 체크하면 비어있어도 된다라는 뜻

- type
  - text :
  - varchar : 
  - timestamp : 
- default
  - 만들어질 때 바로 디폴트로 넣을 데이터

- 연관관계 맺기
  - 하나의 row 드래그 앤 드랍

여기서 다 만들고, 테이블 생성, 복붙하고, select 문 작성해서 insert하면 된다.

쿼리를 10개~20개 짜면 된다. (한방쿼리? 이게 맞아?)





화면 스크린샷 - 엑셀에 붙이기 - 쿼리문 결과 그 옆에 넣기 - 쿼리문에 필요한 쿼리문 쭉쭉 넣기 : 실습영상에 있다.





sql문을 처음 공부하면 그거 공부하는 것도 생각보다 시간이 오래 걸린다.

공부하기 어려우면 자료 받을 수 있다

질문도 많이 해라

join을 공부했는데 join을 쓰는 방법을 모르겠습니다

subquery이런거 모르겠어요

등등등

여기서부터 밀리는 경우가 상당히 많으니까 빡집중!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1



이번주 task

ERD설계를 이틀 내로 마무리 하는 걸로 하는것.

Aquery 툴로 설계를 하고 올리기.

남들의 피드백도 봐야한다!!!!!!!!!!!!!!!!!!!!

3일차부터는 sql만드는 걸로 들어가야 한다.

---

### 질문

join문

![image-20210703182632758](C:\Users\4545a\AppData\Roaming\Typora\typora-user-images\image-20210703182632758.png)

한방쿼리

화면의 데이터를 한번에 뽑아오는 것

테이블 하나에 모든 데이터가 있는 것이 아니다.

모든 테이블들을 join을 통해 하나로 테이블 만드는 것 - 한방쿼리

db에 한번에 때려넣는것



예를 들어 유튜브 화면을 보여준다고 생각하자.

동영상 제목

채녈 이름

유저 이름

등등을 보여주어야 하는데, 이때 각각의 테이블을 참조해야하는 상황이 생긴다.



이때 각각 쿼리문을 select from 해서 만드는 것은 쉽다.

한방쿼리는 이렇게 하는 것이 아니라, 

각 테이블들을 join - on이라는걸 사용.

유저 부분의 userid, 채널 부분의 userid를 기준으로 합치라는 명령어. 내부적으로 userid를 기준으로(가운데가 공통부분) 왼쪽은 유저에서 온 부분, 오른쪽은 채널에서 온 부분으로 테이블 하나가 만들어진다.

이때, 한 쿼리문으로 사용 가능한다.



RDS 서비스

DB용 컴퓨팅 서비스 



쿼리

DB가 있고, DBSM이 있는데, 

